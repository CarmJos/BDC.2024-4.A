# 模型选用
使用了 VGG-16 模型。

VGG-16介绍，是一个CNN模型，常用于图像识别、目标检测等。

VGG-16结构: https://www.geeksforgeeks.org/vgg-16-cnn-model/

## 参数量计算
### 沉积岩分类网络
输入层: 0

卷积层1-1: 3x3x3x64 = 1,728

卷积层1-2: 3x3x64x64 = 36,864

池化层1: 0

卷积层2-1: 3x3x64x128 = 73,728

卷积层2-2: 3x3x128x128 = 147,456

池化层2: 0

卷积层3-1: 3x3x128x256 = 294,912

卷积层3-2: 3x3x256x256 = 589,824

卷积层3-3: 3x3x256x256 = 589,824

池化层3: 0

卷积层4-1: 3x3x256x512 = 1,179,648

卷积层4-2: 3x3x512x512 = 2,359,296

卷积层4-3: 3x3x512x512 = 2,359,296

池化层4: 0

卷积层5-1: 3x3x512x512 = 2,359,296

卷积层5-2: 3x3x512x512 = 2,359,296

卷积层5-3: 3x3x512x512 = 2,359,296

池化层5: 0

全连接层1: 7x7x512x4096 = 102,760,448

全连接层2: 4096x4096 = 16,777,216

全连接层3: 4096x11 = 45,056

总参数: 134,293,184

### 岩石大类分类网络
与上述网络一致但全连接层3改为 4096*3 = 12288

总参数: 134,260,416

## 优化
为了能更容易的训练VGGNet，引入了批量规范化层BN。

# 训练参数
每次传递的样本个数`batch_size`: 32

学习率`learning_rate`: 0.01

训练轮数`num_epochs`: 100(沉积岩分类); 20(岩石大类三分类)

# 数据集
训练集:验证集 约为 3:1

## 数据增强
训练集的图像进行随机翻转、随机灰度变化，以提高模型的泛化能力，

# 题解思路（大致）
## 第一题
根据excel表格将28种沉积岩分类标注为11个类别，经过预处理后作为VGG-16沉积岩分类网络的数据集进行训练，保存训练好的模型用于后续识别工作。

为提高模型的泛化能力，使用数据增强增加训练数据的多样性，防止模型过拟合。

## 第二题
将变质岩、沉积岩和火成岩三个子数据集进行标注，进行一系列预处理，构建VGG-16岩石大类分类网络，将上述数据集投入分类网络进行训练并保存模型。

通过对比不同模型的性能，选择最优模型进行测试。

## 第三题
对第一题的网络经过一系列优化和调参并评估后，训练出沉积岩分类模型，将题目中的数据经预处理后经模型前向传播后根据结果和标注得到具体类别，并填写到“赛题提交结果.xlsx”表格中。
